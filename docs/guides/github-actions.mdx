---
title: GitHub Actions
description: Automate your workflows with mux run in GitHub Actions
---

`mux run` is designed for automation scenarios like CI/CD pipelines. This guide shows how to integrate mux into your GitHub Actions workflows.

## Prerequisites

1. **API Key**: Add your `ANTHROPIC_API_KEY` (or other provider key) to your repository's secrets. See [Providers](/config/providers) for details on configuring API keys.
2. **npm/bun**: The workflow will install Mux via `bunx` or `npx`

## Basic Usage

Here's a minimal example that runs Mux in a GitHub Action:

```yaml
- name: Mux Review
  env:
    ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
    GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  run: bunx mux run "Review this PR for critical issues. If any are found, exit with 1 to block merge."
```

`mux run` supports agent-controlled exit codes, so the workflow step can fail when issues are found.

### Key Options for CI

| Option           | Purpose                                        |
| ---------------- | ---------------------------------------------- |
| `--quiet`        | Only output final result (cleaner logs)        |
| `--json`         | Machine-readable NDJSON output for parsing     |
| `--budget <usd>` | Limit spending per run (e.g., `--budget 1.00`) |

## Example: Auto-Cleanup Workflow

This is the exact workflow used live in the Mux repo (see [`.github/workflows/auto-cleanup.yml`](https://github.com/coder/mux/blob/main/.github/workflows/auto-cleanup.yml)). It runs periodically to identify low-risk cleanup opportunities and maintains a refactor PR with improvements.

{/* BEGIN AUTO_CLEANUP_WORKFLOW */}

```yaml
# Periodically cleans up the codebase and maintains a refactor PR.
# SETUP: Add OPENAI_API_KEY to repository secrets.

name: Auto-Cleanup

on:
  schedule:
    - cron: "0 */4 * * *" # Every 4 hours
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write

jobs:
  cleanup:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5 # v4.3.1
        with:
          fetch-depth: 0
      - uses: oven-sh/setup-bun@b7a1c7ccf290d58743029c4f6903da283811b979 # v2.1.0

      - name: Cleanup with mux
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          [ -z "$OPENAI_API_KEY" ] && echo "Skipping (no API key)" && exit 0

          bunx mux@next run --model openai:gpt-5.2 --thinking xhigh --service-tier priority "
            You are invoked periodically to clean up the codebase and update a PR called
            'refactor: auto-cleanup'. First, try to find that open PR. If it exists, consult
            its commit messages to identify the last commits considered.

            After that initial investigation, look at the recent commits on main that haven't
            been considered. Identify extremely low-risk cleanup opportunities in the form of:

            - deduplicating code
            - increasing variable name clarity
            - general maintainability improvements

            and submit them to the refactor PR (creating a new one if there is no available
            open one). The repository maintainers will occasionally merge that PR on their
            own schedule.
          "
```

{/* END AUTO_CLEANUP_WORKFLOW */}

<CardGroup cols={2}>
  <Card title="CLI Reference" icon="terminal" href="/reference/cli">
    Full CLI documentation
  </Card>
  <Card title="Agentic Git Identity" icon="user-robot" href="/config/agentic-git-identity">
    Configure separate Git identity for AI commits
  </Card>
</CardGroup>
